---
permalink: /Cleaning python/
tags: 
  - Python Projects
layout: tags
categories: 
  - Python
---

# Uber dataset in Rusia with Python

This idea is based on replying the exercises from the previous post, but this time I prefered in a different database, this one is for Uber 
and its location is in Rusia. The dataset is very similar to the other, but in this we do not have the sources and destinations, and it's 
considerable small only 677 rows and 25 variables.

This time, we will use only Python to replicate all the exercises from the previous post.

Let's begin....

```python
import pandas as pd 
import numpy as np

rus = rusiacsv

del rusiacsv

rus.drop('trip_completed_at', inplace=True, axis=1)

rus.head(10)
```

We only dropped one varible because it contained repeated information from other time variables.


## Trip end time

```python
rus['date'] = [d.date() for d in rus['trip_end_time']]
rus['time'] = [d.time() for d in rus['trip_end_time']]

rus['trip_end_time'] = pd.to_datetime(rus['trip_end_time'])

rus.drop('trip_end_time', inplace=True, axis=1)
```

## Trip start time
```python
rus['trip_time'] = pd.to_datetime(rus['trip_time'])

rus['s_date'] = [d.date() for d in rus['trip_time']]
rus['s_time'] = [d.time() for d in rus['trip_time']]

rus.drop('trip_time', inplace=True, axis=1)
```

## Converting time
```python
rus['total_time'] = pd.to_datetime(rus['total_time'])
rus['wait_time'] = pd.to_datetime(rus['wait_time'])
rus['trip_type'] = pd.to_datetime(rus['trip_type'])

rus['total_time'] = [d.time() for d in rus['total_time']]
rus['wait_time'] = [d.time() for d in rus['wait_time']]
rus['trip_type'] = [d.time() for d in rus['trip_type']]
```

## rename colums
```python
rus.rename({"total_time": "trip_t", "wait_time": "total_t", "trip_type": "wait_t"}, 
           axis=1, inplace=True)

rus.rename({"driver_photo_url": "sex", "trip_map_image_url": "pickup_lat", "country": "city",
            'rub_usd_exchange_rate':'exc','distance_kms':'distance', 'temperature_value':'temperature',
            }, axis=1, inplace=True)
```
## Dummies for sex

```python
rus["sex"]= rus["sex"].replace('Male', 1)
rus["sex"]= rus["sex"].replace('Female', 0)
```


## save file ----------------------------
```python
rus.to_csv(r'C:\Users\MADM\Tecno\rus1.csv', index = None, header=True)
```

For the next plot, we expect some basic statistical analysis of the variables.

We must admit that the tasks of loading, cleaning and preparing the database was more easy than in R.


To be continued... 



